تقویم شمسی برای AdvancedFilter
از	بابک محمودی / ۴ تیر ۱۴۰۲ / پرنیان, مایکروسافت شیرپوینت

امکان AdvancedFilter یک افزونه‌ی کاربردی از SharePointBoost است که امکان فیلتر کردن پیشرفته بنا بر نیز کاربر را فراهم میکند. شکل زیر این امکان را برای یک لیست سفارشی نشان میدهد:

طبیعتا یکی از نیازمندی‌های کاربر فارسی زبان استفاده از تقویم شمسی در این ابزار است. در این مطلب چگونگی پیاده‌سازی تقویم شمسی در این افزونه توضیح داده میشود.

در این خصوص نکته‌ی اصلی توجه به این موضوع است که تقویم و کنترل انتخاب تاریخ در این افزونه بر اساس ابزار jquery ساخته شده است. برای تقویم شمسی در کنترل انتخاب تاریخ در jquery کارهای خوبی انجام شده است که یک نمونه‌ی آن توسط مهدی هاشمی‌نژاد بوده است. بنابراین در این بخش از کار کافیست تغییرات لازم برای تقویم شمسی افزوده شود. کدهای مربوط به jquery در فایل jquery-ui-1.18.13.custom.min.js قرار دارد:

بنابر این لازم است امکان تقویم شمسی به این پرونده اضافه شود. برای اینکار یکی از پیاده‌سازیهای تقویم شمسی (نسخه‌ی هاشمی‌نژاد) را به این پرونده اضافه میکنیم:

 

ضمنا در انتهای فایل لازم میشود، تقویم پیش‌فرض روی هجری شمسی تنظیم شود:

به این ترتیب قسمت کنترل انتخاب تاریخ و پشتیبانی تقویم شمسی در آن تقریبا تکمیل میشود.

تغییرات بعدی مورد نیاز در فایل ribbon_command.js است. در اینجا اطلاعات فیلتر که از سمت سرور فرستاده میشود برای نمایش آماده میشود. در سمت سرور اطلاعات تاریخ همواره به شکل dd/mm/yy فرستاده میشوند. برای نمایش درست آنها لازم است که این فرمت به شکل yy/mm/dd تغییر داده شود. برای اینکار تابع fixFilterSettings به این فایل اضافه شده است:

 

آخرین پرونده‌ای که لازم است تغییر داده شود، فایل SPBClassifierAdvancedFilterUI.resx است که در آن عبارتهای بکار رفته ترجمه میشود.

شکل زیر برخی از این عبارتها را نشان میدهد.

این تغییرات در نسخه‌ی جدید پرنیان برای شیرپوینت اعمال شده است و در این نسخه تقویم شمسی برای AdvancedFilter پشتیبانی میشود. برای استفاده از این امکانات با گستره‌نگار تماس بگیرید.

